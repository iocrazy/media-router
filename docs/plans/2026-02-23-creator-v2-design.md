# 创作工具增强 v2 设计

> 日期：2026-02-23
> 目标：增强视频创作工具功能，让截图看起来专业丰富，通过抖音 aweme.share 审核。

## 背景

v1 创作工具只有 5 个基础功能（裁剪/拼接/调速/文字/滤镜），审核时功能显得单薄。需要增强到与剪映等专业工具视觉对齐的水平。

## 设计目标

- **截图优先**：每个面板都有丰富的视觉元素，截图效果专业
- **三入口创作**：模板、自由编辑、AI 创作，展示多种创作模式
- **画布编辑**：核心升级，从"视频处理器"提升到"视频创作平台"
- **最小后端依赖**：尽量纯前端，AI 功能可后续接入

## 新增功能

### 1. 模板系统

纯前端静态数据，8 个模板卡片（Vlog/卡点/带货/图文/音乐/特效/教程/美食），每个模板定义一组预设参数（滤镜+文字样式+比例+推荐音乐）。

### 2. 画面裁剪 + 比例

可视化裁剪框覆盖在视频预览上，支持：
- 自由裁剪
- 锁定比例：9:16 / 16:9 / 1:1 / 4:3 / 3:4
- FFmpeg `crop` filter 实现

### 3. 音乐库

10-15 首免费版权音乐，分 4 类（热门/轻快/抒情/电子）：
- 列表展示，可预览播放
- 音乐音量 + 原声音量滑块
- FFmpeg `-i audio.mp3 -filter_complex amix` 叠加

### 4. 扩展滤镜

从 5 个扩展到 15 个，分 4 类（自然/人像/美食/风景）：
- 滤镜强度滑块
- 复用现有 FFmpeg filter 架构

### 5. 贴纸面板

emoji/贴纸网格，分 4 类（热门/表情/装饰/文字）。选择后添加到画布层，可拖拽。

### 6. 字幕样式

TextPanel 增强，增加 6 种预设字幕模板：
- 白字黑边、彩虹字、气泡框、霓虹灯、打字机、弹幕风

### 7. 画布编辑器（核心升级）

使用 Konva.js + react-konva 在视频预览层之上叠加交互画布：
- 自由拖拽文字/贴纸/图片
- 缩放、旋转
- 层级调整
- 画布工具栏：文字/图片/贴纸/形状
- 导出时画布内容渲染为图片叠加到视频

### 8. AI 创作

创作页第三个入口，AI 创作页面：
- 文字描述输入框
- 风格选择（写实/动漫/插画/3D）
- 尺寸选择（竖屏/横屏）
- 生成图片/生成视频按钮
- 结果网格展示
- 对接外部 API（硅基流动/通义万相），视频生成先做展示 UI

## 页面流程

```
创作页（三入口）
├── 「从模板开始」→ 模板选择 → 选择视频 → 编辑器（模板参数预填）
├── 「自由编辑」  → 选择视频 → 编辑器
└── 「AI 创作」   → AI 创作页面 → 可选编辑器
```

## 编辑器工具栏

更新为 9 个工具（横向滚动）：
```
裁剪 | 拼接 | 调速 | 比例 | 文字 | 滤镜 | 音乐 | 贴纸 | 画布
```

## 组件架构

```
components/creator/
├── TemplatePicker.tsx          — 模板选择网格
├── VideoCanvas.tsx             — Konva 画布编辑器
├── CanvasToolbar.tsx           — 画布工具栏
├── CropOverlay.tsx             — 裁剪框交互层
├── panels/
│   ├── CropPanel.tsx           — 裁剪 + 比例面板
│   ├── MusicPanel.tsx          — 音乐库
│   ├── StickerPanel.tsx        — 贴纸面板
│   ├── FilterPanel.tsx         — 重构：15 滤镜 + 分类 + 强度
│   └── TextPanel.tsx           — 重构：6 种字幕样式
├── ai/
│   ├── AiCreator.tsx           — AI 创作页面
│   └── AiResultGrid.tsx        — 生成结果展示
└── ToolBar.tsx                 — 更新：9 个工具
```

## 新增依赖

```json
{
  "konva": "^9.x",
  "react-konva": "^18.x"
}
```

## 技术实现

| 功能 | 技术 | 说明 |
|------|------|------|
| 画布编辑器 | Konva.js + react-konva | ~150KB，拖拽/缩放/旋转 |
| 画面裁剪 | CSS 裁剪框 + FFmpeg crop | 前端交互 + FFmpeg 处理 |
| AI 生成图片 | 外部 API | 文生图，按次计费 |
| AI 生成视频 | 展示性 UI 优先 | 后续接入 |
| 画布→视频 | Canvas toDataURL + FFmpeg overlay | 画布导出帧叠加到视频 |
| 音乐叠加 | FFmpeg amix filter | 双音轨混合 |

## 不做的事情

- 不做多轨时间线编辑器
- 不做实时滤镜预览（性能不够）
- 不做 AI 模型本地推理
- 不做视频录制功能
- 不做云端项目保存
